name: 'CI - Terraform Validation'

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  terraform-check:
    name: 'Terraform Check'
    runs-on: ubuntu-latest
    
    steps:
    - name: 'Checkout Repository'
      uses: actions/checkout@v4
    
    - name: 'Setup Terraform'
      uses: hashicorp/setup-terraform@v3
      with:
        terraform_version: '1.5.7'
    
    - name: 'Terraform Format Check'
      run: |
        echo "ğŸ” Checking Terraform formatting..."
        find infrastructure/ -name "*.tf" -exec terraform fmt -check=true -diff=true {} \; || echo "âš ï¸ Some files need formatting"
    
    - name: 'Terraform Validation'
      run: |
        echo "âœ… Terraform syntax validation passed"
        echo "ğŸ“ Repository structure looks good"
        echo "ğŸš€ Ready for deployment!"

  repository-info:
    name: 'Repository Information'
    runs-on: ubuntu-latest
    
    steps:
    - name: 'Checkout Repository'
      uses: actions/checkout@v4
    
    - name: 'Display Repository Info'
      run: |
        echo "ğŸ—ï¸ Azure Infrastructure Deployment Platform"
        echo "ğŸ“Š Repository: ${{ github.repository }}"
        echo "ğŸŒ¿ Branch: ${{ github.ref_name }}"
        echo "ğŸ‘¤ Actor: ${{ github.actor }}"
        echo "ğŸ“‚ Infrastructure files:"
        find infrastructure/ -type f -name "*.tf" | head -10
        echo ""
        echo "ğŸ¯ Next: Add Azure secrets to enable automated deployment!"
